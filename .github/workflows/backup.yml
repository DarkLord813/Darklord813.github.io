name: Auto Backup
on:
  push:
    branches: [main]
  schedule:
    - cron: '0 2 * * *'  # Daily at 2 AM
  workflow_dispatch:

# ğŸ”‘ THIS IS THE KEY FIX: Add permissions
permissions:
  contents: write

jobs:
  backup:
    runs-on: ubuntu-latest
    steps:
      - name: ğŸ“¥ Checkout code
        uses: actions/checkout@v3
        with:
          token: ${{ secrets.GITHUB_TOKEN }}
          
      - name: âš™ï¸ Setup Git
        run: |
          git config --global user.name "github-actions[bot]"
          git config --global user.email "github-actions[bot]@users.noreply.github.com"
          
      - name: ğŸ“‚ Create and Push Backup
        run: |
          # Create a timestamp for unique branch name
          TIMESTAMP=$(date +'%Y%m%d-%H%M%S')
          
          # Force push to backup branch (creates or updates)
          git push origin HEAD:refs/heads/backup-$TIMESTAMP --force
          git push origin HEAD:refs/heads/latest-backup --force
          
          echo "âœ… Backup created: backup-$TIMESTAMP"
          echo "ğŸ“ View latest: https://github.com/DarkLord813/Darklord813.github.io/tree/latest-backup"
